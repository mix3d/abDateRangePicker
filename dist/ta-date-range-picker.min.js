(function(){angular.module("tawani.utils",["pasvaz.bindonce"]);angular.module("tawani.utils").directive("taDateRangePicker",["$compile","$timeout",function(n,t){function f(n){n.ranges[n.ranges.length-1].range!=r&&n.ranges.push({label:"Custom Range",range:r});n.resetRangeClass();n.ranges[n.ranges.length-1].active&&(n.showCalendars=!0)}function e(n){n.months=[];var t=null,r=null;n.model&&(t=n.model.start,r=n.model.end);t||(t=moment());r||(r=moment());n.months.push(i(t.clone().startOf("month")));n.months.push(i(t.clone().startOf("month").add(1,"month")));n.inputDates=[];n.inputDates.push(t.format("YYYY-MM-DD"));n.inputDates.push(r.format("YYYY-MM-DD"))}function i(n){return{name:n.format("MMM YYYY"),date:n,weeks:o(n)}}function u(n,t,i){return n.month()!==t.month()?i:n.date()}function o(n){for(var s=n.clone().endOf("month"),l=s.date(),e=n.clone().startOf("month"),f=e.clone().day(0),h,c,a=n.month(),v=n.year(),o=[],t,r,i;f<s;){for(h=u(f.clone().day(0),e,1),c=u(f.clone().day(6),e,l),t=[],r=h;r<=c;r++)t.push({number:r,date:new Date(v,a,r)});if(i=t.length,i<7)if(o.length==0)while(i<7)t.splice(0,0,{number:!1,disabled:!0}),i+=1;else while(i<7)t.push({number:!1,disabled:!0}),i+=1;o.push(t);f.add(7,"d")}return o}function s(){return[{label:"This week",range:moment().range(moment().startOf("week").startOf("day"),moment().endOf("week").startOf("day"))},{label:"Next week",range:moment().range(moment().startOf("week").add(1,"week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This month",range:moment().range(moment().startOf("month").startOf("day"),moment().endOf("month").startOf("day"))},{label:"Next month",range:moment().range(moment().startOf("month").add(1,"month").startOf("day"),moment().add(1,"month").endOf("month").startOf("day"))},{label:"Year to date",range:moment().range(moment().startOf("year").startOf("day"),moment().endOf("day"))}]}function h(){return'<div ng-show="visible" ng-click="handlePickerClick($event)" class="ta-daterangepicker"><div bindonce ng-repeat="month in months" class="calendar" ng-show="showCalendars"><div class="input"><input class="input-mini active" type="text" ng-model="inputDates[$index]" ng-change="updateStartOrEndDate($first,$last)" ng-blur="moveToMonth($first,$index)"/><i class="fa fa-calendar"><\/i><a ng-show="$last && currentSelection && currentSelection.start && currentSelection.end" href="" ng-click="clear()"><i class="fa fa-remove"><\/i><\/a><\/div><div class="calendar-table"><table><thead><tr><th class="available"><a ng-if="$first" ng-click="move(month.date, -1, $event)"><i class="fa fa-chevron-left"><\/i> <\/a><\/th><th colspan="5"><div class="month-name" bo-text="month.name"><\/div><\/th><th class="available"> <a ng-if="$last" ng-click="move(month.date, +1, $event)"><i class="fa fa-chevron-right"><\/i> <\/a> <\/th><\/tr><tr><th bindonce ng-repeat="day in weekDays" class="weekday" bo-text="day"><\/th><\/tr><\/thead><tbody><tr bindonce ng-repeat="week in month.weeks"><td ng-repeat="day in week" ng-class="getClassName(day)"><div ng-if="day.number" bo-text="day.number" ng-click="select(day, $event)"><\/div><\/td><\/tr><\/tbody><\/table><\/div><\/div><div class="ranges"><ul><li bindonce ng-repeat="item in ranges" ng-class="{\'active\':item.active}"><div ng-click="setRange(item.range,$event)">{{item.label}}<\/div><\/li><\/ul><div><button class="btn btn-sm btn-success" ng-click="applySelection()" ng-disabled="!showCalendars || !currentSelection || !currentSelection.start || !currentSelection.end">Apply<\/button> <button class="btn btn-sm btn-default" ng-click="hide()">Cancel<\/button><\/div><\/div><\/div>'}var r="CUSTOM";return{scope:{model:"=ngModel",ranges:"=",callback:"&"},template:'<div class="selectbox"><i class="fa fa-calendar"><\/i> <span ng-show="model">{{model.start.format("LL")}} - {{model.end.format("LL")}}<\/span> <span ng-hide="model">Select date range<\/span> <b class="caret"><\/b><\/div>',link:function(u,o){var l,c;u.weekDays=moment.weekdaysMin();u.ranges&&u.ranges.length||(u.ranges=s());u.show=function(){return u.currentSelection=null,e(u),u.selection=u.model,f(u),u.visible=!0};u.hide=function(n){return n!=null&&typeof n.stopPropagation=="function"&&n.stopPropagation(),u.visible=!1,u.start=null};u.handlePickerClick=function(n){if(n!=null)return typeof n.stopPropagation=="function"?n.stopPropagation():void 0};u.select=function(n,t){if(t!=null&&typeof t.stopPropagation=="function"&&t.stopPropagation(),!n.disabled){var i=u.getCurrentSelection(),r=n.date;i.start&&i.end||!i.start?(i.start=moment(r),i.end=null,u.inputDates[0]=i.start.format("YYYY-MM-DD")):i.start&&!i.end&&(i.start.isAfter(r,"day")?(i.start=moment(r),u.inputDates[0]=i.start.format("YYYY-MM-DD")):i.start.isBefore(r,"day")&&(i.end=moment(r),u.inputDates[1]=i.end.format("YYYY-MM-DD")));u.resetRangeClass()}};u.setRange=function(n,t){if(n){if(n==r){u.showCalendars=!0;return}u.showCalendars=!1;u.currentSelection=n.clone();u.selection=u.currentSelection.clone();u.ok(t)}};u.ok=function(n){return n!=null&&typeof n.stopPropagation=="function"&&n.stopPropagation(),u.model=u.selection,t(function(){if(u.callback)return u.callback()}),u.hide()};u.clear=function(n){n!=null&&typeof n.stopPropagation=="function"&&n.stopPropagation();u.selection=null;u.ok(n)};u.applySelection=function(n){n!=null&&typeof n.stopPropagation=="function"&&n.stopPropagation();u.showCalendars=!0;u.selection=moment.range(u.currentSelection.start.clone(),u.currentSelection.end.clone());u.ok(n)};u.move=function(n,t,r){r!=null&&typeof r.stopPropagation=="function"&&r.stopPropagation();var f,e;t<0?(f=n.clone().add(t,"months"),e=f.clone().add(1,"months")):(e=n.clone().add(t,"months"),f=e.clone().add(-1,"months"));u.months[0]=i(f);u.months[1]=i(e)};u.getCurrentSelection=function(){return!u.currentSelection&&u.selection&&(u.currentSelection=u.selection.clone()),u.currentSelection||(u.currentSelection={}),u.currentSelection};u.getClassName=function(n){var t=u.getCurrentSelection();if(!n||n.number==!1)return"off";if(t){if(t.start&&t.start.isSame(n.date,"day"))return"active start-date";if(t.end&&t.end.isSame(n.date,"day"))return"active end-date";if(t.start&&t.end&&t.start.isBefore(n.date,"day")&&t.end.isAfter(n.date,"day"))return"in-range"}return"available"};u.resetRangeClass=function(){for(var n,f=!1,t=u.getCurrentSelection(),i=0;i<u.ranges.length;i++)n=u.ranges[i],n.active=!1,n.range&&n.range!=r&&t.start&&t.end&&t.start.isSame(n.range.start,"day")&&t.end.isSame(n.range.end,"day")&&(n.active=!0,f=!0);f||(u.ranges[u.ranges.length-1].active=!0)};u.updateStartOrEndDate=function(n,t){var i=u.getCurrentSelection(),r,f;if(n){if(r=moment(u.inputDates[0]),!r)return;i.start=r;(!i.end||i.end.isBefore(r,"day"))&&(i.end=r,u.inputDates[1]=i.end.format("YYYY-MM-DD"))}else if(t){if(f=moment(u.inputDates[1]),!f)return;i.end=f;(!i.start||i.start.isAfter(f,"day"))&&(i.start=f,u.inputDates[0]=i.start.format("YYYY-MM-DD"))}u.resetRangeClass()};u.moveToMonth=function(n,t){if(n){var r=moment(u.inputDates[0]);r&&(r.isSame(u.months[t].date,"month")||(u.months[0]=i(r.clone()),u.months[1]=i(r.clone().add(1,"months"))))}};l=n(angular.element(h()))(u);o.append(l);o.bind("click",function(n){return n!=null&&typeof n.stopPropagation=="function"&&n.stopPropagation(),u.$apply(function(){return u.visible?u.hide():u.show()})});c=function(){return u.$apply(function(){return u.hide()}),!0};angular.element(document).bind("click",c);u.$on("$destroy",function(){return angular.element(document).unbind("click",c)})}}}])})();
/*
//# sourceMappingURL=ta-date-range-picker.min.js.map
*/